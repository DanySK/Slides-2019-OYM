+++
title = "From nature inspiration to aggregate computing"
outputs = ["Reveal"]
[reveal_hugo]
theme = "blood"
slide_number = "true"
+++

##### From
### nature inspiration
##### to
### aggregate computing

[Danilo Pianini](http://www.danilopianini.org)

<footer>
  <div style="font-size: 80%"> University of Bologna</div>
</footer>

---

{{< slide id="monza" background-image="img/monza.png" >}}

---

{{< slide background-image="img/monza-dark.png" >}}

<section data-noprocess>
  <ul>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=6>"Situatedness"</li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=4>Unpredictability (humans)</li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=1>High density</li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=2>Heterogeneity</li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=3>Mobility</li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=5>Openness</li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=7>Safety concerns</li>
  </ul>
</section>

{{% note %}}



{{% /note %}}

---

<video width="120%" height="120%" autoplay controls loop><source data-src="video/stampede.mp4" type="video/webm" /></video>

---

{{< slide background-image="img/monza-dark.png" >}}

### Engineering this thing I

1. {{< frag c="Condensate all the information in a single point">}}
2. {{< frag c="Process this stuff">}} {{< frag c="...somehow" >}}
3. {{< frag c="Send data back to devices">}}

* {{< frag c="Single point of failure">}}
* {{< frag c="Questionable scalability">}}
* {{< frag c="Misuse of network and computational power">}}
* {{< frag c="Does not play well with high densities">}}
* {{< frag c="High latency">}}
* {{< frag c="Privacy concerns">}}

---

{{< slide background-image="img/monza-dark.png" >}}

### Engineering this thing II

{{< frag c="Decentralize the computation" >}}

* {{< frag c="Centralized algorithms can't be used anymore" >}}
* {{< frag c="No one has everything under control..." >}}
* {{< frag c="...yet the system must behave coherently" >}}

{{< frag c="...yeah, cool... how? :|" >}}

---

<video width="100%" height="100%" controls><source data-src="video/mrbean720.mp4" type="video/webm" /></video>

---

{{< slide background-image="img/spider-man.jpg" >}}

---

{{< slide background-image="img/leaf-background.jpg" >}}

{{< youtube id="uEYcY7WfDTY?start=7">}}

---

{{< slide background-image="img/leaf-background.jpg" >}}

{{< youtube id="uhfXbSSrabw" autostart="true">}}

---

{{< slide background-image="img/leaf-background.jpg" >}}

![Gecko Pad design](img/geckopad.jpg)

---

{{< slide background-image="img/leaf-background.jpg" >}}

<img src="img/biomimicry-gecko-climging-pads.jpg" style="height:10em;"/>

[{{< frag c="Human climbing with efficiently scaled gecko-inspired dry adhesives" >}}](https://doi.org/10.1098/rsif.2014.0675)

---

{{< slide background-image="img/leaf-background.jpg" >}}

{{< youtube id="5SNlG_2sFXc" autostart="true">}}

---

{{< slide background-image="img/500nozomi.jpg" >}}

## [{{< frag c="500 Series Shinkansen" >}}](https://en.wikipedia.org/wiki/500_Series_Shinkansen)

[{{< frag c="Air pressure change when exiting tunnels caused thunder-like noise disturbing in a 300m range" >}}](https://en.wikipedia.org/wiki/500_Series_Shinkansen)

---

{{< slide background-image="img/leaf-background.jpg" >}}

{{< youtube id="veQ2ilQrzMU?start=20">}}

---

{{< slide background-image="img/700series.jpg" >}}

## [{{< frag c="700 Series Shinkansen" >}}](https://en.wikipedia.org/wiki/700_Series_Shinkansen)

[{{< frag c="Kingfisher-like beak -> problem solved." >}}](https://en.wikipedia.org/wiki/700_Series_Shinkansen)

---

{{< slide background-image="img/leaf-background.jpg" >}}

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/M8YjvHYbZ9w?start=46" style="position: absolute; top: 0; left: 0; width: 50%; height: 50%; border:0;" allowfullscreen title="asdsad"></iframe>
  <iframe src="https://www.youtube.com/embed/rVlhMGQgDkY?start=26" style="position: absolute; bottom: 0; left: 0; width: 50%; height: 50%; border:0;" allowfullscreen title="asdsad"></iframe>
  <iframe src="https://www.youtube.com/embed/wE3fmFTtP9g?start=43" style="position: absolute; top: 0; right: 0; width: 50%; height: 50%; border:0;" allowfullscreen title="asdsad"></iframe>
  <iframe src="https://www.youtube.com/embed/tf7IEVTDjng?start=50" style="position: absolute; bottom: 0; right: 0; width: 50%; height: 50%; border:0;" allowfullscreen title="asdsad"></iframe>
</div>

---

{{< slide background-image="img/leaf-background.jpg" >}}

### Back to the problem

* {{< frag c="Distributed system" >}}
* {{< frag c="Heterogeneous devices" >}}
* {{< frag c="No leaders" >}}
* {{< frag c="Openness" >}}

<p>
{{< frag c="Any inspiration?" >}}
</p>

---

{{< slide background-image="img/leaf-background.jpg" >}}

<div id="div1" style="width: 50%; height: 50%; float: left; overflow: hidden;">
  <img src="img/ants.jpg" style="position:relative; width: 100%; height: 100%; border: 0; margin:auto; overflow: hidden;"/>
</div>
<div class="fragment" id="div2" style="width: 50%; height: 50%; float: left; overflow: hidden;">
  <img src="img/termites.jpg" style="position:relative; width: 100%; height: 100%; border: 0; margin:auto; overflow: hidden;"/>
</div>
<div class="fragment" id="div3" style="width: 50%; height: 50%; float: left; overflow: hidden;">
  <img src="img/firefly.jpg" style="position:relative; width: 100%; height: 100%; border: 0; margin:auto; overflow: hidden;"/>
</div>
<div class="fragment" id="div4" style="width: 50%; height: 50%; float: left; overflow: hidden;">
  <img src="img/ecosystem.jpg" style="position:relative; width: 100%; height: 100%; border: 0; margin:auto; overflow: hidden;"/>
</div>

---

{{< slide background-image="img/leaf-background.jpg" >}}

### Ant food search

* Ants wander around searching for food
* If food is found:
  * the ant gets very excited
  * it starts emitting pheromone
  * it picks the food up
  * it gets back to the nest, leaving a *pheromone trail*
* Ants are attracted by pheromone trails of others
* Pheromones naturally evaporate after a while

---

{{< slide background-image="img/leaf-background.jpg" >}}

<iframe src="https://www.netlogoweb.org/launch#https://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Ants.nlogo" style="position: relative; top: 0; left: 0; width: 100%; height: 14em;"> </iframe>

---

{{< slide background-image="img/leaf-background.jpg" >}}

### Termites stockpiling

* Termites wander around
* If they find a piece of wood, they pick it up
  * If they find another piece of wood, they drop the one they have

---

{{< slide background-image="img/leaf-background.jpg" >}}

<iframe src="https://www.netlogoweb.org/launch#https://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Termites.nlogo" style="position: relative; top: 0; left: 0; width: 100%; height: 14em;"> </iframe>

---

{{< slide background-image="img/leaf-background.jpg" >}}

### Firefly synchronization

* Every some time, a firefly gets aroused and blinks
* Watching another firefly blinking makes it very likely to get aroused

---

{{< slide background-image="img/leaf-background.jpg" >}}

<iframe src="https://www.netlogoweb.org/launch#https://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Fireflies.nlogo" style="position: relative; top: 0; left: 0; width: 100%; height: 14em;"> </iframe>

---

{{< slide background-image="img/leaf-background.jpg" >}}

{{< youtube id="nSIPesWIDx8" autostart="true">}}

---

{{< slide background-image="img/leaf-background.jpg" >}}

#### Side effects on multiple scales

**simple** *local* behaviours

<p class="fragment" data-fragment-index=1> ↓↓↓ </p>
<p class="fragment" data-fragment-index=1> <b>complex</b> <i>global</i> behaviour </p>

{{< frag c="effects reified on different scales" >}}

---

{{< slide background-image="img/leaf-background.jpg" >}}

#### The bad part

emergent behaviour is difficult to forecast

> simple behavioural and communicational rules, global effects

<p class="fragment" data-fragment-index=1> ↓↓↓ </p>

<blockquote class="fragment" data-fragment-index=1> small mistakes, global consequences</blockquote>

---

{{< slide background-image="img/leaf-background.jpg" >}}

### Local-to-global

> something as small as the flutter of a butterfly's wing can ultimately cause a typhoon halfway around the world

---

{{< slide background-image="img/leaf-background.jpg" >}}

#### The bad part

* {{< frag c="Engineering emergency is hard" >}}
* {{< frag c="Engineers don't like lack of control" >}}
* {{< frag c="Poor composability" >}}
* {{< frag c="Poor reusability" >}}

<p>
{{< frag c="nature can bet on numbers, we can't." >}}
</p>

---

#### A different take

We want to specify the global behavior, and have a machine (a compiler, or an interpreter) figure out what to execute.

---

#### Computer science is a story of **paradigms**

* *Machine code is unusable* {{< frag c="-> Assembly" >}}
* *Instructions are too complicated* {{< frag c="-> Structured programming (FORTRAN, C...)" >}}
* *Data structure should have behavior as well* {{< frag c="-> Object orientation (C++, Java...)" >}}
* *Behavior should be isolated* {{< frag c="-> Functional programming (LISP, Haskell...)" >}}
* *I need parallelism and mobility* {{< frag c="-> Actors (Akka)" >}}

---

#### We want to write global behavior

{{< frag c="-> Aggregate Programming (Protelis, Scafi....)" >}}

---

{{< slide transition="none" transition-speed="fast" >}}

#### Aggregate programming: idea
<img src="img/Fig1.png"/>

devices

---

{{< slide transition="none" transition-speed="fast" >}}

#### Aggregate programming: idea
<img src="img/Fig2.png"/>

logical network

---

{{< slide transition="none" transition-speed="fast" >}}

#### Aggregate programming: idea
<img src="img/Fig2.png"/>

each device holds some values

---

{{< slide transition="none" transition-speed="fast" >}}

#### Aggregate programming: idea
<img src="img/Fig3.png"/>

interpret such values as a field in space-time

---

{{< slide transition="none" transition-speed="fast" >}}

#### Aggregate programming: idea
<img src="img/Fig3.png"/>

(computational field)

---

{{< slide transition="none" transition-speed="fast" >}}

#### Aggregate programming: idea
<img src="img/Fig3.png"/>

↑↑↑ Compute on these things ↑↑↑

---

{{< slide background-image="img/bg.png" >}}

{{% section %}}

### Aggregate programming

* our machine is the *ensemble* of situated devices
* computing happens by means of combining fields
<p class="fragment fade-in">straightforward mapping to functional languages</p>
<ul>
  <li class="fragment fade-in">compositionality by function composition (<i>divide et impera</i>)</li>
  <li class="fragment fade-in">Low adoption barrier for those who know functional programming!</li>
  <li class="fragment fade-in">networking and platform hidden under the hood</li>
</ul>

---

{{< slide background-image="img/bg.png" >}}

<section data-noprocess>
    <p class="fragment fade-in" data-fragment-index=6><b>↓Nice place to work↓</b></p>
    <p class="fragment fade-in" data-fragment-index=5>Reusable aggregate library</p>
    <p class="fragment fade-in" data-fragment-index=4>Self-stabilizing blocks</p>
    <p class="fragment fade-in" data-fragment-index=3>Language primitives</p>
    <p class="fragment fade-in" data-fragment-index=2>Interpreter</p>
    <p class="fragment fade-in" data-fragment-index=1>Device abstraction (sensors, actuators)</p>
    Underlying platform (cloud? actors? LoRaWAN?)
</section>

{{% /section %}}

---

{{< slide background-image="img/bg.svg" >}}

### Field computation example
<div style="width: 60%; margin: auto;">
<img src="img/ing-mix5.pdf.png" />
</div>

---

{{< slide background-image="img/bg.svg" >}}

### Space: fields of fields

<div style="width: 100%; margin: auto;">
<img src="img/ing-nbr.pdf.png" />
</div>

---

{{< slide background-image="img/bg.svg" >}}

### Time: field evolution

<img src="img/ing-rep.pdf.png" />

---

{{< slide background-image="img/bg.svg" >}}

### If: domain separation
<img src="img/ing-if2.pdf.png" />

---

{{< slide background-image="img/bg.svg" >}}

### Real systems: subject to "relativistic effects"
<div style="width: 70%; margin: auto;">
<img src="img/spacetime.png" />
</div>

---


{{% section %}}

{{< slide background-image="img/bg.svg" >}}

### The feel of it

<video width="100%" height="80%" autoplay controls><source data-src="video/ieeeiot-upgrade.mkv" type="video/webm" /></video>
[red](https://vimeo.com/260445665) means overcrowding

---

### The feel of it

```java
import ...
// A field counting people around each point in space
def countNearby(range) {
  let human = rep(h <- env.has("human")) { h };
  sumHood PlusSelf(
    mux(human && nbrRange() < range) { 1 } else { 0 })
}
```
actual code from [Modelling and simulation of Opportunistic IoT Services with Aggregate Computing](https://doi.org/10.1016/j.future.2018.09.005)

---

### The feel of it

```java
import ...
// A field estimating people density in an area
def densityEst(p, range, w) {
  countNearby(range) / (p * pi * range ^ 2 * w)
}
```
(actual code from [Modelling and simulation of Opportunistic IoT Services with Aggregate Computing](https://doi.org/10.1016/j.future.2018.09.005))

---

### The feel of it

```java
import ...
// A field of boolean, true if the area is overcrowded
def dangerousDensity(p, range, dangerousDensity, groupSize, w) {
  let partition = S(range, nbrRange);
  let localDensity = densityEst(p, range, w);
  let avg = summarize(partition, sum, localDensity, 0)
    / summarize(partition, sum, 1, 0);
  let count = summarize(partition, sum, 1 / p, 0);
  avg > dangerousDensity && count > groupSize
}
```
(actual code from [Modelling and simulation of Opportunistic IoT Services with Aggregate Computing](https://doi.org/10.1016/j.future.2018.09.005))

---

### The feel of it

```java
import ...
/* A field that partitions space in safe, overcrowded,
   and overcrowding areas, given a certain time window */
def crowdTracking(p, range, w, maxDense,
      dangerThr, groupSize, time) {
  if (isRecentEvent(densityEst(p, range, w) > maxDense, time)) {
    if (dangerousDensity(p, range, dangerThr, groupSize, w)) {
      overcrowded()
    } else { atRisk() }
  } else { none() }
}
// Application code: crowd density tracking in a 60s window
crowdTracking(0.005, 30, 0.25, 1.08, 2.17, 300, 60);
```
(actual code from [Modelling and simulation of Opportunistic IoT Services with Aggregate Computing](https://doi.org/10.1016/j.future.2018.09.005))

{{% /section %}}


---

{{< slide background-image="img/bg.png" >}}

#### Engineering toolchain

* [A higher order calculus](https://arxiv.org/abs/1610.08116)
* Two practical languages
    * [<img src="img/logoprotelis.svg" style="width:3%;margin:0"/> Protelis](www.protelis.org)
      * Java-hosted stand-alone language
    * [Scafi](https://scafi.github.io/)
      * Scala internal DSL
* Multiple simulators (it's easy to attach them)
  * [<img src="img/logoalchemist.svg" style="width:3%;margin:0"/> Alchemist](https://alchemistsimulator.github.io)
     * Supports both Protelis and Scafi
  * [NASA WorldWind](https://github.com/Protelis/Protelis-Demo-Visualized)

---


{{< slide background-image="img/bg.png" >}}

#### Integration

* Requirements:
    * Devices exchange data with their "neighbors"
        * Whatever a "neighborhood" is
* No assumption on the deployment
* No assumption on communication means

---

{{< slide background-image="img/bg.png" >}}

#### Integration

Computation may happen:
<ul>
  <li>on each device</li>
  <li class="fragment fade-in">on the edge</li>
  <li class="fragment fade-in">on the cloud</li>
</ul>


{{< frag c="the aggregate software does not change at all" >}}

---

{{< slide background-image="img/bg.png" >}}

#### Integration

No magic, deployment-specific complexity is simply incapsulated under the hood

<i>{{< frag c="divide et impera" >}}</i>

* Write the application thinking of *what* it should do
* Write the platform thinking of *where* it should run
    * And reuse it for future applications

---

{{< slide background-image="img/bg.png" >}}

#### Silver bullet?

<b class="fragment fade-in" data-fragment-index=0>nope</b>

<ul>
  <li class="fragment fade-in-then-semi-out" data-fragment-index=1>Very handy for expressing the "coordination"</li>
  <li class="fragment fade-in-then-semi-out" data-fragment-index=2>Other paradigms are better at the good ol' "local" programming</li>
  <ul>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=2>e.g. I wouldn't develop a GUI in aggregate...</li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=2>(although technically doable)</li>
  </ul>
  <li class="fragment fade-in-then-semi-out" data-fragment-index=3>The final software is usually a mixture of paradigms</li>
</ul>

---

{{< slide background-image="img/bg.png" >}}

#### abstraction is not a free lunch

<p class="fragment fade-in" data-fragment-index=0>abstraction raised by hiding networking and protocols</p>

<ul>
  <li class="fragment fade-in" data-fragment-index=1><b>harder to optimize</b> for bandwidth saving</li>
  <ul>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=2><b>application-specific optimization</b> at the platform level breaks the paradigm</li>
  </ul>
  <li class="fragment fade-in" data-fragment-index=3><b>security</b> is a serious concern</li>
  <ul>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=4>Some work on <a href="https://doi.org/10.1016/j.scico.2018.07.006">application-level countermeasures</a></li>
    <li class="fragment fade-in-then-semi-out" data-fragment-index=5>Platform-level attacks disrupt the paradigm</li>
    <ul>
      <li class="fragment fade-in-then-semi-out" data-fragment-index=5>A work on this <a href ="http://pccmvo-goodtechs-2018.surge.sh/">is being presented right now</a></li>
    </ul>
  </ul>
</ul>

---

#### Appendix: play with it!

[A tutorial for learning Protelis](https://www.slideshare.net/DanySK/practical-aggregate-programming-with-protelis-saso2017) is available

Scafi is better learned by reading [a paper](https://link.springer.com/chapter/10.1007/978-3-030-00302-9_4) (for now)
